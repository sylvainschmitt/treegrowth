[["guyafor.html", "Chapter 6 Guyafor 6.1 Data 6.2 Model 6.3 Fit 6.4 Evolutionary analyses 6.5 Discussion", " Chapter 6 Guyafor In this chapter, I repeated the model fit for the whole Guyafor network. 6.1 Data I used only recruited trees in the censuses with at least 4 measurements of diameter at breast height (DBH, cm). I used only species with at least 4 trees following previous requirements (Tab. 6.1 &amp; Fig. 6.1). Table 6.1: Metrics on inventory data used to fit the full model including sample size (N), memdian, minimum and maximum values for families, genera, species, individuals, observations, cenusus, recruitment year (year0), last censused year (yearmax), recruitment diameter (dbh0) and last censused diameter (dbhmax). N Median Minimum Maximum families 50 genera 164 species 327 individuals 21 911 observations 269 525 census 12 5 30 year0 1 998 1 986 2 011 yearmax 2 021 1 997 2 021 dbh0 11 5 15 dbhmax 14 6 83 Figure 6.1: Tree diameter trajectories in reduced data. Color represent individuals. 6.2 Model I used a Gompertz model (Hérault et al. 2011), were the diameter of individual \\(i\\) at year \\(t\\) is the sum of annual growth from \\(t0\\) to \\(t\\): \\[ DBH_{t,i,s} \\sim \\mathcal N (10 + Gmax_i \\times \\sum _{y=1|DBH_{t=0}} ^{y=t} exp(-\\frac12.[\\frac{log(\\frac{DBH_{t,i}}{100.Dopt_i})}{Ks_i}]^2)), \\sigma) \\\\| Dopt_i \\sim \\mathcal N(Dopt_s,\\sigma_D), Ks_i \\sim \\mathcal N(Ks_s,\\sigma_K) \\] The annual growth rate for individual \\(i\\) at year \\(y\\) with a diameter of \\(DBH_{y,i}\\) is defined following a Gompertz model (Gompertz 1825) already identified as the best model for growth-trajectories in Paracou (Hérault et al. 2011), where \\(Gmax_i\\) is the fixed maximum growth potential of every individual, \\(Dopt_i\\) is the optimal diameter at which the individual reaches its maximum growth potential, and \\(Ks_i\\) is the kurtosis defining the width of the bell-shaped growth-trajectory (see figure 1 in Hérault et al. 2011). \\(Dopt_i\\) and \\(Ks_i\\) are random effects centered on species parameters \\(Dopt_s\\) and \\(Ks_s\\) with associated variances \\(\\sigma_D\\) and \\(\\sigma_K\\). fit &lt;- read_cmdstan_csv(&quot;save/growthguyafor/growth-202210280057-1-361cf6.csv&quot;) draws &lt;- drop(fit$post_warmup_draws) %&gt;% as_data_frame() %&gt;% mutate(iteration = 1:n()) %&gt;% gather(parameter, value, -iteration) vroom::vroom_write(draws, file = &#39;save/growthguyafor/chain1.tsv&#39;) rm(fit, draws) gc() fit &lt;- read_cmdstan_csv(&quot;save/growthguyafor/growth-202210280057-2-361cf6.csv&quot;) draws &lt;- drop(fit$post_warmup_draws) %&gt;% as_data_frame() %&gt;% mutate(iteration = 1:n()) %&gt;% gather(parameter, value, -iteration) vroom::vroom_write(draws, file = &#39;save/growthguyafor/chain2.tsv&#39;) rm(fit, draws) gc() fit &lt;- read_cmdstan_csv(&quot;save/growthguyafor/growth-202210280057-3-361cf6.csv&quot;) draws &lt;- drop(fit$post_warmup_draws) %&gt;% as_data_frame() %&gt;% mutate(iteration = 1:n()) %&gt;% gather(parameter, value, -iteration) vroom::vroom_write(draws, file = &#39;save/growthguyafor/chain3.tsv&#39;) rm(fit, draws) gc() fit &lt;- read_cmdstan_csv(&quot;save/growthguyafor/growth-202210280057-4-361cf6.csv&quot;) draws &lt;- drop(fit$post_warmup_draws) %&gt;% as_data_frame() %&gt;% mutate(iteration = 1:n()) %&gt;% gather(parameter, value, -iteration) vroom::vroom_write(draws, file = &#39;save/growthguyafor/chain4.tsv&#39;) rm(fit, draws) gc() grep gmax chain1.tsv &gt; gmax1.tsv grep gmax chain2.tsv &gt; gmax2.tsv grep gmax chain3.tsv &gt; gmax3.tsv grep gmax chain4.tsv &gt; gmax4.tsv bind_rows( vroom::vroom(&#39;save/growthguyafor/gmax1.tsv&#39;, col_names = c(&quot;iteration&quot;, &quot;parameter&quot;, &quot;value&quot;)) %&gt;% mutate(chain = 1), vroom::vroom(&#39;save/growthguyafor/gmax2.tsv&#39;, col_names = c(&quot;iteration&quot;, &quot;parameter&quot;, &quot;value&quot;)) %&gt;% mutate(chain = 2), vroom::vroom(&#39;save/growthguyafor/gmax3.tsv&#39;, col_names = c(&quot;iteration&quot;, &quot;parameter&quot;, &quot;value&quot;)) %&gt;% mutate(chain = 3), vroom::vroom(&#39;save/growthguyafor/gmax4.tsv&#39;, col_names = c(&quot;iteration&quot;, &quot;parameter&quot;, &quot;value&quot;)) %&gt;% mutate(chain = 4) ) %&gt;% separate(parameter, c(&quot;gmax&quot;, &quot;ind&quot;)) %&gt;% vroom::vroom_write(file = &#39;save/growthguyafor/gmax.tsv&#39;) library(csv2sql) gmax &lt;- vroom::vroom(file = &#39;save/growthguyafor/gmax.tsv&#39;) write_csv(gmax, file = &#39;save/growthguyafor/gmax.csv&#39;) csv_to_sqlite(csv_name = &#39;save/growthguyafor/gmax.csv&#39;, db_name = &#39;save/growthguyafor/gmax.sql&#39;, table_name = &quot;gmax&quot;) unlink(&#39;save/growthguyafor/gmax.csv&#39;) 6.3 Fit Unfortunately, gmax upper limit was set to 5 instead of 10 (overconstrained). But the model with more stringent data had a better behavior with gmax limited to 5. 6.4 Evolutionary analyses Figure 6.2: Distribution of species growth potential (Gmax, cm/yr) in the phylogeny. 6.5 Discussion Within-chain parallelization available with gompertzsumpar model. Next steps: Stop? Use? Run again? Cluster? Who? When? What for? Data paper? References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
