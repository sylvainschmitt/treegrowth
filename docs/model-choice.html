<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Model choice | Tree Growth</title>
  <meta name="description" content="Variation in the growth potential of individual trees at the Paracou research station." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Model choice | Tree Growth" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Variation in the growth potential of individual trees at the Paracou research station." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Model choice | Tree Growth" />
  
  <meta name="twitter:description" content="Variation in the growth potential of individual trees at the Paracou research station." />
  

<meta name="author" content="Sylvain Schmitt" />


<meta name="date" content="2022-04-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="model-full.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script async defer src="https://hypothes.is/embed.js"></script>



<link rel="stylesheet" href="html/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree Growth</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="model-choice.html"><a href="model-choice.html"><i class="fa fa-check"></i><b>1</b> Model choice</a><ul>
<li class="chapter" data-level="1.1" data-path="model-choice.html"><a href="model-choice.html#data"><i class="fa fa-check"></i><b>1.1</b> Data</a></li>
<li class="chapter" data-level="1.2" data-path="model-choice.html"><a href="model-choice.html#michaelis-menten-1"><i class="fa fa-check"></i><b>1.2</b> Michaelis Menten 1</a></li>
<li class="chapter" data-level="1.3" data-path="model-choice.html"><a href="model-choice.html#michaelis-menten-2"><i class="fa fa-check"></i><b>1.3</b> Michaelis Menten 2</a></li>
<li class="chapter" data-level="1.4" data-path="model-choice.html"><a href="model-choice.html#gompertz"><i class="fa fa-check"></i><b>1.4</b> Gompertz</a></li>
<li class="chapter" data-level="1.5" data-path="model-choice.html"><a href="model-choice.html#lognormal"><i class="fa fa-check"></i><b>1.5</b> Lognormal</a></li>
<li class="chapter" data-level="1.6" data-path="model-choice.html"><a href="model-choice.html#polynomial"><i class="fa fa-check"></i><b>1.6</b> Polynomial</a></li>
<li class="chapter" data-level="1.7" data-path="model-choice.html"><a href="model-choice.html#weibul"><i class="fa fa-check"></i><b>1.7</b> Weibul</a></li>
<li class="chapter" data-level="1.8" data-path="model-choice.html"><a href="model-choice.html#amani"><i class="fa fa-check"></i><b>1.8</b> Amani</a></li>
<li class="chapter" data-level="1.9" data-path="model-choice.html"><a href="model-choice.html#gompertz-sum"><i class="fa fa-check"></i><b>1.9</b> Gompertz sum</a></li>
<li class="chapter" data-level="1.10" data-path="model-choice.html"><a href="model-choice.html#gompertz-sum-2"><i class="fa fa-check"></i><b>1.10</b> Gompertz sum 2</a></li>
<li class="chapter" data-level="1.11" data-path="model-choice.html"><a href="model-choice.html#gompertz-sum-3"><i class="fa fa-check"></i><b>1.11</b> Gompertz sum 3</a></li>
<li class="chapter" data-level="1.12" data-path="model-choice.html"><a href="model-choice.html#gompertz-sum-4"><i class="fa fa-check"></i><b>1.12</b> Gompertz sum 4</a></li>
<li class="chapter" data-level="1.13" data-path="model-choice.html"><a href="model-choice.html#comparisons"><i class="fa fa-check"></i><b>1.13</b> Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="model-full.html"><a href="model-full.html"><i class="fa fa-check"></i><b>2</b> Model full</a><ul>
<li class="chapter" data-level="2.1" data-path="model-full.html"><a href="model-full.html#data-1"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="model-full.html"><a href="model-full.html#model"><i class="fa fa-check"></i><b>2.2</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analyses.html"><a href="analyses.html"><i class="fa fa-check"></i><b>3</b> Analyses</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/sylvainschmitt/treegrowth" target="blank">Source</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree Growth</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b><a href="open.html#open">Open Review</a></b>. I want your feedback to make the book better for you and other readers. To add your annotation, <span style="background-color: #3297FD; color: white">select some text</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. To see the annotations of others, click the <i class="h-icon-chevron-left"></i> in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="model-choice" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Model choice</h1>
<p>In this chapter we looked for the best model shape based on quality of fit, cross-validation (LOO), and prediction (RMSEP).</p>
<div id="data" class="section level2">
<h2><span class="header-section-number">1.1</span> Data</h2>
<p><img src="treegrowth_files/figure-html/datafig-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/mmmdatafig-1.png" width="768" /></p>
</div>
<div id="michaelis-menten-1" class="section level2">
<h2><span class="header-section-number">1.2</span> Michaelis Menten 1</h2>
<p>Using time <span class="math inline">\(t\)</span> since recruitment (DBH=10cm) for each individual tree <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[DBH_{i,t} \sim \mathcal N (10 + \frac{\alpha_i \times t}{\beta_i+t}, \sigma)\]</span></p>
<p><img src="treegrowth_files/figure-html/mm1rhat-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/mm1trace-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/mm1pairs-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/mm1alpha-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/mm1beta-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/mm1preds-1.png" width="768" /></p>
</div>
<div id="michaelis-menten-2" class="section level2">
<h2><span class="header-section-number">1.3</span> Michaelis Menten 2</h2>
<p>Using time <span class="math inline">\(t\)</span> since recruitment (DBH=10cm) for each individual tree <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[DBH_{i,t} \sim \mathcal N (10 + \frac{1}{\frac{1}{\alpha_i} + \frac{1}{\gamma_i \times t}}, \sigma)\]</span></p>
<p><img src="treegrowth_files/figure-html/mm2rhat-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/mm2trace-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/mm2pairs-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/mm2alpha-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/mm2gamma-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/mm2preds-1.png" width="768" /></p>
</div>
<div id="gompertz" class="section level2">
<h2><span class="header-section-number">1.4</span> Gompertz</h2>
<p>Using time <span class="math inline">\(t\)</span> since recruitment (DBH=10cm) for each individual tree <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[DBH_{i,s,t} \sim \mathcal N (DBH_{i,t-i} + Gmax_i \times  exp(-\frac12.[\frac{log(\frac{DBH_{i,t-i}}{100.Dopt_i})}{Ks_i}]^2)\times\Delta t, \sigma)\]</span></p>
<p><img src="treegrowth_files/figure-html/gompertzrhat-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertztrace-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertzpairs-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertzgmax-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertzpreds-1.png" width="768" /></p>
</div>
<div id="lognormal" class="section level2">
<h2><span class="header-section-number">1.5</span> Lognormal</h2>
<p>Using time <span class="math inline">\(t\)</span> since recruitment (DBH=10cm) for each individual tree <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[DBH_{i,t} \sim \mathcal N (10 +\beta \times log(t), \sigma)\]</span></p>
<p><img src="treegrowth_files/figure-html/logrhat-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/logtrace-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/logpairs-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/loggmax-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/logpreds-1.png" width="768" /></p>
</div>
<div id="polynomial" class="section level2">
<h2><span class="header-section-number">1.6</span> Polynomial</h2>
<p>Using time <span class="math inline">\(t\)</span> since recruitment (DBH=10cm) for each individual tree <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[DBH_{i,t} \sim \mathcal N (\alpha \times t^3 + \beta_i \times t^2+ \gamma_i \times t + 10, \sigma)\]</span></p>
<p><img src="treegrowth_files/figure-html/polyrhat-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/polytrace-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/polypairs-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/polyalpha-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/polypreds-1.png" width="768" /></p>
</div>
<div id="weibul" class="section level2">
<h2><span class="header-section-number">1.7</span> Weibul</h2>
<p>Using time <span class="math inline">\(t\)</span> since recruitment (DBH=10cm) for each individual tree <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[DBH_{i,t} \sim \mathcal N (10 + \alpha \times (1 − e^{-t_i/\beta}) , \sigma)\]</span></p>
</div>
<div id="amani" class="section level2">
<h2><span class="header-section-number">1.8</span> Amani</h2>
<p>Using time <span class="math inline">\(t\)</span> since recruitment (DBH=10cm) for each individual tree <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[DBH_{i,t} \sim \mathcal N (\alpha \times (1 − e^{-\lambda \times (\frac{t_i}{\theta})^\beta}) , \sigma)\]</span></p>
</div>
<div id="gompertz-sum" class="section level2">
<h2><span class="header-section-number">1.9</span> Gompertz sum</h2>
<p>Using time <span class="math inline">\(t\)</span> since recruitment (DBH=10cm) for each individual tree <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[  DBH_{t,i} \sim \mathcal N  (10 + gmax_i \times \sum _{y=0} ^{y=t} exp(-\frac12.[\frac{log(\frac{DBH_{t,i}}{100.Dopt_i})}{Ks_i}]^2)), \sigma)\]</span></p>
<p><img src="treegrowth_files/figure-html/gompertzsumrhat-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertzsumtrace-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertzsumpairs-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertzsumalpha-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertzsumpreds-1.png" width="768" /></p>
</div>
<div id="gompertz-sum-2" class="section level2">
<h2><span class="header-section-number">1.10</span> Gompertz sum 2</h2>
<p>Using time <span class="math inline">\(t\)</span> since recruitment (DBH=10cm) for each individual tree <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[  DBH_{t,i} \sim \mathcal N  (10 + gmax_i \times \sum _{y=0} ^{y=t} exp(-\frac12.[\frac{log(\frac{DBH_{t,i}}{100.Dopt_i})}{Ks_i}]^2)), \sigma)\]</span></p>
<p><img src="treegrowth_files/figure-html/gompertzsum2rhat-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertzsum2trace-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertzsum2pairs-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertzsum2alpha-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertzsum2preds-1.png" width="768" /></p>
<p><img src="treegrowth_files/figure-html/gompertzsum2res-1.png" width="768" /></p>
</div>
<div id="gompertz-sum-3" class="section level2">
<h2><span class="header-section-number">1.11</span> Gompertz sum 3</h2>
<p><em>Using cmdstanr.</em></p>
<p>Using time <span class="math inline">\(t\)</span> since recruitment (DBH=10cm) for each individual tree <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[  DBH_{t,i} \sim \mathcal N  (10 + gmax_i \times \sum _{y=0} ^{y=t} exp(-\frac12.[\frac{log(\frac{DBH_{t,i}}{100.Dopt_i})}{Ks_i}]^2)), \sigma)\]</span></p>
<p><img src="treegrowth_files/figure-html/gompertzsum3trace-1.png" width="768" /></p>
</div>
<div id="gompertz-sum-4" class="section level2">
<h2><span class="header-section-number">1.12</span> Gompertz sum 4</h2>
<p><em>Using cmdstanr and reduce_sum for parralelisation.</em></p>
<p>Using time <span class="math inline">\(t\)</span> since recruitment (DBH=10cm) for each individual tree <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[  DBH_{t,i} \sim \mathcal N  (10 + gmax_i \times \sum _{y=0} ^{y=t} exp(-\frac12.[\frac{log(\frac{DBH_{t,i}}{100.Dopt_i})}{Ks_i}]^2)), \sigma)\]</span></p>
</div>
<div id="comparisons" class="section level2">
<h2><span class="header-section-number">1.13</span> Comparisons</h2>
<p><img src="treegrowth_files/figure-html/rmsep-1.png" width="768" /></p>
<table>
<colgroup>
<col width="19%" />
<col width="11%" />
<col width="9%" />
<col width="9%" />
<col width="12%" />
<col width="9%" />
<col width="10%" />
<col width="10%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">elpd_diff</th>
<th align="right">se_diff</th>
<th align="right">elpd_loo</th>
<th align="right">se_elpd_loo</th>
<th align="right">p_loo</th>
<th align="right">se_p_loo</th>
<th align="right">looic</th>
<th align="right">se_looic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Gompertz</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">252.5768</td>
<td align="right">5.297475</td>
<td align="right">3.707155</td>
<td align="right">0.1762043</td>
<td align="right">-505.1535</td>
<td align="right">10.59495</td>
</tr>
<tr class="even">
<td align="left">Gompertz sum 3</td>
<td align="right">-3.353666</td>
<td align="right">5.580909</td>
<td align="right">249.2231</td>
<td align="right">5.118095</td>
<td align="right">4.638442</td>
<td align="right">0.1742171</td>
<td align="right">-498.4462</td>
<td align="right">10.23619</td>
</tr>
<tr class="odd">
<td align="left">Gompertz sum 4</td>
<td align="right">-3.501480</td>
<td align="right">5.576029</td>
<td align="right">249.0753</td>
<td align="right">5.114114</td>
<td align="right">4.696683</td>
<td align="right">0.1790171</td>
<td align="right">-498.1506</td>
<td align="right">10.22823</td>
</tr>
<tr class="even">
<td align="left">Gompertz sum 2</td>
<td align="right">-3.736661</td>
<td align="right">5.576073</td>
<td align="right">248.8401</td>
<td align="right">5.114695</td>
<td align="right">4.670876</td>
<td align="right">0.1768954</td>
<td align="right">-497.6802</td>
<td align="right">10.22939</td>
</tr>
<tr class="odd">
<td align="left">Gompertz sum</td>
<td align="right">-14.808735</td>
<td align="right">5.659101</td>
<td align="right">237.7680</td>
<td align="right">5.346394</td>
<td align="right">4.706502</td>
<td align="right">0.1766864</td>
<td align="right">-475.5360</td>
<td align="right">10.69279</td>
</tr>
<tr class="even">
<td align="left">Polynomial</td>
<td align="right">-24.480108</td>
<td align="right">5.929703</td>
<td align="right">228.0967</td>
<td align="right">5.071009</td>
<td align="right">5.276272</td>
<td align="right">0.1798597</td>
<td align="right">-456.1933</td>
<td align="right">10.14202</td>
</tr>
<tr class="odd">
<td align="left">Michaelis Menten 2</td>
<td align="right">-26.205735</td>
<td align="right">6.521274</td>
<td align="right">226.3710</td>
<td align="right">5.386964</td>
<td align="right">3.609515</td>
<td align="right">0.1349292</td>
<td align="right">-452.7420</td>
<td align="right">10.77393</td>
</tr>
<tr class="even">
<td align="left">Lognormal</td>
<td align="right">-28.691175</td>
<td align="right">7.186175</td>
<td align="right">223.8856</td>
<td align="right">5.273457</td>
<td align="right">2.125079</td>
<td align="right">0.0730310</td>
<td align="right">-447.7712</td>
<td align="right">10.54691</td>
</tr>
<tr class="odd">
<td align="left">Michaelis Menten 1</td>
<td align="right">-38.408940</td>
<td align="right">7.045362</td>
<td align="right">214.1678</td>
<td align="right">5.445341</td>
<td align="right">2.822001</td>
<td align="right">0.0934159</td>
<td align="right">-428.3356</td>
<td align="right">10.89068</td>
</tr>
</tbody>
</table>
<p><img src="treegrowth_files/figure-html/time-1.png" width="768" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-full.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
