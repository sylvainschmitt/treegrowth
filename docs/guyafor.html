<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Guyafor | Tree Growth</title>
  <meta name="description" content="Variation in the growth potential of individual trees at the Paracou research station." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Guyafor | Tree Growth" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Variation in the growth potential of individual trees at the Paracou research station." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Guyafor | Tree Growth" />
  
  <meta name="twitter:description" content="Variation in the growth potential of individual trees at the Paracou research station." />
  

<meta name="author" content="Sylvain Schmitt" />


<meta name="date" content="2023-01-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="functional-analyses.html"/>
<link rel="next" href="microtopo.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script async defer src="https://hypothes.is/embed.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="html/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree Growth</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="model-shape.html"><a href="model-shape.html"><i class="fa fa-check"></i><b>1</b> Model shape</a>
<ul>
<li class="chapter" data-level="1.1" data-path="model-shape.html"><a href="model-shape.html#data"><i class="fa fa-check"></i><b>1.1</b> Data</a></li>
<li class="chapter" data-level="1.2" data-path="model-shape.html"><a href="model-shape.html#michaelis-menten"><i class="fa fa-check"></i><b>1.2</b> Michaelis Menten</a></li>
<li class="chapter" data-level="1.3" data-path="model-shape.html"><a href="model-shape.html#gompertz"><i class="fa fa-check"></i><b>1.3</b> Gompertz</a></li>
<li class="chapter" data-level="1.4" data-path="model-shape.html"><a href="model-shape.html#lognormal"><i class="fa fa-check"></i><b>1.4</b> Lognormal</a></li>
<li class="chapter" data-level="1.5" data-path="model-shape.html"><a href="model-shape.html#polynomial"><i class="fa fa-check"></i><b>1.5</b> Polynomial</a></li>
<li class="chapter" data-level="1.6" data-path="model-shape.html"><a href="model-shape.html#weibul"><i class="fa fa-check"></i><b>1.6</b> Weibul</a></li>
<li class="chapter" data-level="1.7" data-path="model-shape.html"><a href="model-shape.html#amani"><i class="fa fa-check"></i><b>1.7</b> Amani</a></li>
<li class="chapter" data-level="1.8" data-path="model-shape.html"><a href="model-shape.html#gompertz-sum"><i class="fa fa-check"></i><b>1.8</b> Gompertz sum</a></li>
<li class="chapter" data-level="1.9" data-path="model-shape.html"><a href="model-shape.html#comparisons"><i class="fa fa-check"></i><b>1.9</b> Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="species-integration.html"><a href="species-integration.html"><i class="fa fa-check"></i><b>2</b> Species integration</a>
<ul>
<li class="chapter" data-level="2.1" data-path="species-integration.html"><a href="species-integration.html#data-1"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="species-integration.html"><a href="species-integration.html#individual-fixed"><i class="fa fa-check"></i><b>2.2</b> Individual fixed</a></li>
<li class="chapter" data-level="2.3" data-path="species-integration.html"><a href="species-integration.html#individual-random"><i class="fa fa-check"></i><b>2.3</b> Individual random</a></li>
<li class="chapter" data-level="2.4" data-path="species-integration.html"><a href="species-integration.html#species-fixed"><i class="fa fa-check"></i><b>2.4</b> Species fixed</a></li>
<li class="chapter" data-level="2.5" data-path="species-integration.html"><a href="species-integration.html#species-random"><i class="fa fa-check"></i><b>2.5</b> Species random</a></li>
<li class="chapter" data-level="2.6" data-path="species-integration.html"><a href="species-integration.html#dmax"><i class="fa fa-check"></i><b>2.6</b> Dmax</a></li>
<li class="chapter" data-level="2.7" data-path="species-integration.html"><a href="species-integration.html#comparisons-1"><i class="fa fa-check"></i><b>2.7</b> Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="model-fit.html"><a href="model-fit.html"><i class="fa fa-check"></i><b>3</b> Model fit</a>
<ul>
<li class="chapter" data-level="3.1" data-path="model-fit.html"><a href="model-fit.html#data-2"><i class="fa fa-check"></i><b>3.1</b> Data</a></li>
<li class="chapter" data-level="3.2" data-path="model-fit.html"><a href="model-fit.html#model"><i class="fa fa-check"></i><b>3.2</b> Model</a></li>
<li class="chapter" data-level="3.3" data-path="model-fit.html"><a href="model-fit.html#fit"><i class="fa fa-check"></i><b>3.3</b> Fit</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="eco-evolutionary-analyses.html"><a href="eco-evolutionary-analyses.html"><i class="fa fa-check"></i><b>4</b> Eco-evolutionary analyses</a>
<ul>
<li class="chapter" data-level="4.1" data-path="eco-evolutionary-analyses.html"><a href="eco-evolutionary-analyses.html#methods"><i class="fa fa-check"></i><b>4.1</b> Methods</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="eco-evolutionary-analyses.html"><a href="eco-evolutionary-analyses.html#environmental-descriptors"><i class="fa fa-check"></i><b>4.1.1</b> Environmental descriptors</a></li>
<li class="chapter" data-level="4.1.2" data-path="eco-evolutionary-analyses.html"><a href="eco-evolutionary-analyses.html#analyses"><i class="fa fa-check"></i><b>4.1.2</b> Analyses</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="eco-evolutionary-analyses.html"><a href="eco-evolutionary-analyses.html#results"><i class="fa fa-check"></i><b>4.2</b> Results</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="eco-evolutionary-analyses.html"><a href="eco-evolutionary-analyses.html#general"><i class="fa fa-check"></i><b>4.2.1</b> General</a></li>
<li class="chapter" data-level="4.2.2" data-path="eco-evolutionary-analyses.html"><a href="eco-evolutionary-analyses.html#phylogenetic"><i class="fa fa-check"></i><b>4.2.2</b> Phylogenetic</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functional-analyses.html"><a href="functional-analyses.html"><i class="fa fa-check"></i><b>5</b> Functional analyses</a>
<ul>
<li class="chapter" data-level="5.1" data-path="functional-analyses.html"><a href="functional-analyses.html#methods-1"><i class="fa fa-check"></i><b>5.1</b> Methods</a></li>
<li class="chapter" data-level="5.2" data-path="functional-analyses.html"><a href="functional-analyses.html#results-1"><i class="fa fa-check"></i><b>5.2</b> Results</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="functional-analyses.html"><a href="functional-analyses.html#all"><i class="fa fa-check"></i><b>5.2.1</b> All</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="guyafor.html"><a href="guyafor.html"><i class="fa fa-check"></i><b>6</b> Guyafor</a>
<ul>
<li class="chapter" data-level="6.1" data-path="guyafor.html"><a href="guyafor.html#data-3"><i class="fa fa-check"></i><b>6.1</b> Data</a></li>
<li class="chapter" data-level="6.2" data-path="guyafor.html"><a href="guyafor.html#model-1"><i class="fa fa-check"></i><b>6.2</b> Model</a></li>
<li class="chapter" data-level="6.3" data-path="guyafor.html"><a href="guyafor.html#fit-1"><i class="fa fa-check"></i><b>6.3</b> Fit</a></li>
<li class="chapter" data-level="6.4" data-path="guyafor.html"><a href="guyafor.html#evolutionary-analyses"><i class="fa fa-check"></i><b>6.4</b> Evolutionary analyses</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="microtopo.html"><a href="microtopo.html"><i class="fa fa-check"></i><b>7</b> MicroTopo</a>
<ul>
<li class="chapter" data-level="7.1" data-path="microtopo.html"><a href="microtopo.html#functional-traits"><i class="fa fa-check"></i><b>7.1</b> Functional traits</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="microtopo.html"><a href="microtopo.html#all-1"><i class="fa fa-check"></i><b>7.1.1</b> All</a></li>
<li class="chapter" data-level="7.1.2" data-path="microtopo.html"><a href="microtopo.html#interspecific"><i class="fa fa-check"></i><b>7.1.2</b> Interspecific</a></li>
<li class="chapter" data-level="7.1.3" data-path="microtopo.html"><a href="microtopo.html#intraspecific"><i class="fa fa-check"></i><b>7.1.3</b> Intraspecific</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="microtopo.html"><a href="microtopo.html#growth"><i class="fa fa-check"></i><b>7.2</b> Growth</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="microtopo.html"><a href="microtopo.html#interspecific-1"><i class="fa fa-check"></i><b>7.2.1</b> Interspecific</a></li>
<li class="chapter" data-level="7.2.2" data-path="microtopo.html"><a href="microtopo.html#intraspecific-1"><i class="fa fa-check"></i><b>7.2.2</b> Intraspecific</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/sylvainschmitt/treegrowth" target="blank">Source</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree Growth</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b><a href="open.html#open">Open Review</a></b>. I want your feedback to make the book better for you and other readers. To add your annotation, <span style="background-color: #3297FD; color: white">select some text</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. To see the annotations of others, click the <i class="h-icon-chevron-left"></i> in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="guyafor" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Guyafor<a href="guyafor.html#guyafor" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter, I repeated the model fit for the whole Guyafor network.</p>
<div id="data-3" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Data<a href="guyafor.html#data-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I used only recruited trees in the censuses with at least 4 measurements of diameter at breast height (DBH, cm).
I used only species with at least 4 trees following previous requirements (Tab. <a href="guyafor.html#tab:guyafortab">6.1</a> &amp; Fig. <a href="guyafor.html#fig:mdataguyaforfig">6.1</a>).</p>
<table>
<caption><span id="tab:guyafortab">Table 6.1: </span>Metrics on inventory data used to fit the full model including sample size (N), memdian, minimum and maximum values for families, genera, species, individuals, observations, cenusus, recruitment year (year0), last censused year (yearmax), recruitment diameter (dbh0) and last censused diameter (dbhmax).</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">N</th>
<th align="right">Median</th>
<th align="right">Minimum</th>
<th align="right">Maximum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">families</td>
<td align="right">50</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">genera</td>
<td align="right">164</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">species</td>
<td align="right">327</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">individuals</td>
<td align="right">21 911</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">observations</td>
<td align="right">269 525</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">census</td>
<td align="right"></td>
<td align="right">12</td>
<td align="right">5</td>
<td align="right">30</td>
</tr>
<tr class="odd">
<td align="left">year0</td>
<td align="right"></td>
<td align="right">1 998</td>
<td align="right">1 986</td>
<td align="right">2 011</td>
</tr>
<tr class="even">
<td align="left">yearmax</td>
<td align="right"></td>
<td align="right">2 021</td>
<td align="right">1 997</td>
<td align="right">2 021</td>
</tr>
<tr class="odd">
<td align="left">dbh0</td>
<td align="right"></td>
<td align="right">11</td>
<td align="right">5</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="left">dbhmax</td>
<td align="right"></td>
<td align="right">14</td>
<td align="right">6</td>
<td align="right">83</td>
</tr>
</tbody>
</table>
<div class="figure"><span style="display:block;" id="fig:mdataguyaforfig"></span>
<img src="treegrowth_files/figure-html/mdataguyaforfig-1.png" alt="Tree diameter trajectories in reduced data. Color represent individuals." width="768" />
<p class="caption">
Figure 6.1: Tree diameter trajectories in reduced data. Color represent individuals.
</p>
</div>
</div>
<div id="model-1" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Model<a href="guyafor.html#model-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I used a Gompertz model <span class="citation">(<a href="#ref-Herault2011" role="doc-biblioref">Hérault <em>et al.</em> 2011</a>)</span>, were the diameter of individual <span class="math inline">\(i\)</span> at year <span class="math inline">\(t\)</span> is the sum of annual growth from <span class="math inline">\(t0\)</span> to <span class="math inline">\(t\)</span>:</p>
<p><span class="math display">\[  DBH_{t,i,s} \sim \mathcal N  (10 + Gmax_i \times \sum _{y=1|DBH_{t=0}} ^{y=t} exp(-\frac12.[\frac{log(\frac{DBH_{t,i}}{100.Dopt_i})}{Ks_i}]^2)), \sigma) \\| Dopt_i \sim \mathcal N(Dopt_s,\sigma_D), Ks_i \sim \mathcal N(Ks_s,\sigma_K) \]</span></p>
<p>The annual growth rate for individual <span class="math inline">\(i\)</span> at year <span class="math inline">\(y\)</span> with a diameter of <span class="math inline">\(DBH_{y,i}\)</span> is defined following a Gompertz model <span class="citation">(<a href="#ref-Gompertz1825" role="doc-biblioref">Gompertz 1825</a>)</span> already identified as the best model for growth-trajectories in Paracou <span class="citation">(<a href="#ref-Herault2011" role="doc-biblioref">Hérault <em>et al.</em> 2011</a>)</span>,
where <span class="math inline">\(Gmax_i\)</span> is the fixed maximum growth potential of every individual,
<span class="math inline">\(Dopt_i\)</span> is the optimal diameter at which the individual reaches its maximum growth potential,
and <span class="math inline">\(Ks_i\)</span> is the kurtosis defining the width of the bell-shaped growth-trajectory <span class="citation">(see figure 1 in <a href="#ref-Herault2011" role="doc-biblioref">Hérault <em>et al.</em> 2011</a>)</span>.
<span class="math inline">\(Dopt_i\)</span> and <span class="math inline">\(Ks_i\)</span> are random effects centered on species parameters <span class="math inline">\(Dopt_s\)</span> and <span class="math inline">\(Ks_s\)</span> with associated variances <span class="math inline">\(\sigma_D\)</span> and <span class="math inline">\(\sigma_K\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="guyafor.html#cb1-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">read_cmdstan_csv</span>(<span class="st">&quot;save/growthguyafor/growth-202210280057-1-361cf6.csv&quot;</span>)</span>
<span id="cb1-2"><a href="guyafor.html#cb1-2" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">drop</span>(fit<span class="sc">$</span>post_warmup_draws) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="guyafor.html#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_data_frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="guyafor.html#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iteration =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="guyafor.html#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(parameter, value, <span class="sc">-</span>iteration)</span>
<span id="cb1-6"><a href="guyafor.html#cb1-6" aria-hidden="true" tabindex="-1"></a>vroom<span class="sc">::</span><span class="fu">vroom_write</span>(draws, <span class="at">file =</span> <span class="st">&#39;save/growthguyafor/chain1.tsv&#39;</span>)</span>
<span id="cb1-7"><a href="guyafor.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(fit, draws)</span>
<span id="cb1-8"><a href="guyafor.html#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="guyafor.html#cb2-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">read_cmdstan_csv</span>(<span class="st">&quot;save/growthguyafor/growth-202210280057-2-361cf6.csv&quot;</span>)</span>
<span id="cb2-2"><a href="guyafor.html#cb2-2" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">drop</span>(fit<span class="sc">$</span>post_warmup_draws) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="guyafor.html#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_data_frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="guyafor.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iteration =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="guyafor.html#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(parameter, value, <span class="sc">-</span>iteration)</span>
<span id="cb2-6"><a href="guyafor.html#cb2-6" aria-hidden="true" tabindex="-1"></a>vroom<span class="sc">::</span><span class="fu">vroom_write</span>(draws, <span class="at">file =</span> <span class="st">&#39;save/growthguyafor/chain2.tsv&#39;</span>)</span>
<span id="cb2-7"><a href="guyafor.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(fit, draws)</span>
<span id="cb2-8"><a href="guyafor.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="guyafor.html#cb3-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">read_cmdstan_csv</span>(<span class="st">&quot;save/growthguyafor/growth-202210280057-3-361cf6.csv&quot;</span>)</span>
<span id="cb3-2"><a href="guyafor.html#cb3-2" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">drop</span>(fit<span class="sc">$</span>post_warmup_draws) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="guyafor.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_data_frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="guyafor.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iteration =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="guyafor.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(parameter, value, <span class="sc">-</span>iteration)</span>
<span id="cb3-6"><a href="guyafor.html#cb3-6" aria-hidden="true" tabindex="-1"></a>vroom<span class="sc">::</span><span class="fu">vroom_write</span>(draws, <span class="at">file =</span> <span class="st">&#39;save/growthguyafor/chain3.tsv&#39;</span>)</span>
<span id="cb3-7"><a href="guyafor.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(fit, draws)</span>
<span id="cb3-8"><a href="guyafor.html#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="guyafor.html#cb4-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">read_cmdstan_csv</span>(<span class="st">&quot;save/growthguyafor/growth-202210280057-4-361cf6.csv&quot;</span>)</span>
<span id="cb4-2"><a href="guyafor.html#cb4-2" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">drop</span>(fit<span class="sc">$</span>post_warmup_draws) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="guyafor.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_data_frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="guyafor.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iteration =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="guyafor.html#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(parameter, value, <span class="sc">-</span>iteration)</span>
<span id="cb4-6"><a href="guyafor.html#cb4-6" aria-hidden="true" tabindex="-1"></a>vroom<span class="sc">::</span><span class="fu">vroom_write</span>(draws, <span class="at">file =</span> <span class="st">&#39;save/growthguyafor/chain4.tsv&#39;</span>)</span>
<span id="cb4-7"><a href="guyafor.html#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(fit, draws)</span>
<span id="cb4-8"><a href="guyafor.html#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="guyafor.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> gmax chain1.tsv <span class="op">&gt;</span> gmax1.tsv</span>
<span id="cb5-2"><a href="guyafor.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> gmax chain2.tsv <span class="op">&gt;</span> gmax2.tsv</span>
<span id="cb5-3"><a href="guyafor.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> gmax chain3.tsv <span class="op">&gt;</span> gmax3.tsv</span>
<span id="cb5-4"><a href="guyafor.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> gmax chain4.tsv <span class="op">&gt;</span> gmax4.tsv</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="guyafor.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb6-2"><a href="guyafor.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  vroom<span class="sc">::</span><span class="fu">vroom</span>(<span class="st">&#39;save/growthguyafor/gmax1.tsv&#39;</span>, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&quot;iteration&quot;</span>, <span class="st">&quot;parameter&quot;</span>, <span class="st">&quot;value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="guyafor.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chain =</span> <span class="dv">1</span>),</span>
<span id="cb6-4"><a href="guyafor.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  vroom<span class="sc">::</span><span class="fu">vroom</span>(<span class="st">&#39;save/growthguyafor/gmax2.tsv&#39;</span>, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&quot;iteration&quot;</span>, <span class="st">&quot;parameter&quot;</span>, <span class="st">&quot;value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="guyafor.html#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chain =</span> <span class="dv">2</span>),</span>
<span id="cb6-6"><a href="guyafor.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  vroom<span class="sc">::</span><span class="fu">vroom</span>(<span class="st">&#39;save/growthguyafor/gmax3.tsv&#39;</span>, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&quot;iteration&quot;</span>, <span class="st">&quot;parameter&quot;</span>, <span class="st">&quot;value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="guyafor.html#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chain =</span> <span class="dv">3</span>),</span>
<span id="cb6-8"><a href="guyafor.html#cb6-8" aria-hidden="true" tabindex="-1"></a>  vroom<span class="sc">::</span><span class="fu">vroom</span>(<span class="st">&#39;save/growthguyafor/gmax4.tsv&#39;</span>, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&quot;iteration&quot;</span>, <span class="st">&quot;parameter&quot;</span>, <span class="st">&quot;value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="guyafor.html#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chain =</span> <span class="dv">4</span>)</span>
<span id="cb6-10"><a href="guyafor.html#cb6-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="guyafor.html#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(parameter, <span class="fu">c</span>(<span class="st">&quot;gmax&quot;</span>, <span class="st">&quot;ind&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-12"><a href="guyafor.html#cb6-12" aria-hidden="true" tabindex="-1"></a>  vroom<span class="sc">::</span><span class="fu">vroom_write</span>(<span class="at">file =</span> <span class="st">&#39;save/growthguyafor/gmax.tsv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="guyafor.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(csv2sql)</span>
<span id="cb7-2"><a href="guyafor.html#cb7-2" aria-hidden="true" tabindex="-1"></a>gmax <span class="ot">&lt;-</span> vroom<span class="sc">::</span><span class="fu">vroom</span>(<span class="at">file =</span> <span class="st">&#39;save/growthguyafor/gmax.tsv&#39;</span>)</span>
<span id="cb7-3"><a href="guyafor.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(gmax, <span class="at">file =</span> <span class="st">&#39;save/growthguyafor/gmax.csv&#39;</span>)</span>
<span id="cb7-4"><a href="guyafor.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">csv_to_sqlite</span>(<span class="at">csv_name =</span> <span class="st">&#39;save/growthguyafor/gmax.csv&#39;</span>, </span>
<span id="cb7-5"><a href="guyafor.html#cb7-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">db_name =</span> <span class="st">&#39;save/growthguyafor/gmax.sql&#39;</span>, </span>
<span id="cb7-6"><a href="guyafor.html#cb7-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">table_name =</span> <span class="st">&quot;gmax&quot;</span>)</span>
<span id="cb7-7"><a href="guyafor.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">&#39;save/growthguyafor/gmax.csv&#39;</span>)</span></code></pre></div>
</div>
<div id="fit-1" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Fit<a href="guyafor.html#fit-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="treegrowth_files/figure-html/growthguyaforgmax-1.png" width="768" /></p>
</div>
<div id="evolutionary-analyses" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Evolutionary analyses<a href="guyafor.html#evolutionary-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="figure"><span style="display:block;" id="fig:gmaxphyloc"></span>
<img src="save/figs/phylogenyguyafor.png" alt="Distribution of species growth potential (Gmax, cm/yr) in the phylogeny." width="2460" />
<p class="caption">
Figure 6.2: Distribution of species growth potential (Gmax, cm/yr) in the phylogeny.
</p>
</div>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Gompertz1825" class="csl-entry">
Gompertz, B. (1825). <span class="nocase">On the nature of the function expressive of the law of humanmortality, and on a newmode of determining the value of life contingencies</span>. <em>Philosophical Transactions of the Royal Society of London</em>, <strong>115</strong>, 513–583. Retrieved from <a href="https://www.tandfonline.com/doi/full/10.1080/14786445908642737">https://www.tandfonline.com/doi/full/10.1080/14786445908642737</a>
</div>
<div id="ref-Herault2011" class="csl-entry">
Hérault, B., Bachelot, B., Poorter, L., Rossi, V., Bongers, F., Chave, J., Paine, C.E.T., Wagner, F. &amp; Baraloto, C. (2011). <a href="https://doi.org/10.1111/j.1365-2745.2011.01883.x"><span class="nocase">Functional traits shape ontogenetic growth trajectories of rain forest tree species</span></a>. <em>Journal of Ecology</em>, <strong>99</strong>, 1431–1440.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="functional-analyses.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="microtopo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
